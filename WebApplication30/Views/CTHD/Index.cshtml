
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<html>

<head>
    <link href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>

    @if (ViewBag.Err != null)
    {
        <script type="text/javascript" charset="utf-8">
        window.onload = function () {
            alert("@ViewBag.Err");
        }
        </script>
    }
</head>

<body>
    <ol class="breadcrumb">
        <li class="breadcrumb-item">Admin</li>
        <li class="breadcrumb-item">
            <a href="~/HoaDon/Index">Hóa Đơn</a>
        </li>
        <li class="breadcrumb-item">
            <a href="#">Chi Tiết Hóa Đơn</a>
        </li>
        <!-- Breadcrumb Menu-->

    </ol>
    <div class="container-fluid">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    @{
                        var hd = Session["HoaDonAdmin"] as WebApplication30.Models.HoaDon;
                        <form method="post" action="~/NSX/Index" enctype="multipart/form-data">
                            <div class="form-group row">
                                <label for="staticEmail" class="col-sm-2 col-form-label" style="font-weight:bold">Mã Hóa Đơn</label>
                                <div class="col-sm-10">
                                    <input type="text" readonly value="@hd.MaHD" class="form-control" id="tennsx" name="mahd" aria-describedby="emailHelp" placeholder="Enter Tên NSX">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="staticEmail" class="col-sm-2 col-form-label" style="font-weight:bold">Ngày Tạo Hóa Đơn</label>
                                <div class="col-sm-10">
                                    <input type="text" readonly value="@hd.NgayTao" class="form-control" id="tennsx" name="mahd" aria-describedby="emailHelp" placeholder="Enter Tên NSX">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="staticEmail" class="col-sm-2 col-form-label" style="font-weight:bold">Tên Người Nhận</label>
                                <div class="col-sm-10">
                                    <input type="text" readonly value="@hd.TenNguoiNhan" class="form-control" id="tennsx" name="mahd" aria-describedby="emailHelp" placeholder="Enter Tên NSX">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="staticEmail" class="col-sm-2 col-form-label" style="font-weight:bold">Địa Chỉ</label>
                                <div class="col-sm-10">
                                    <input type="text" readonly value="@hd.DiaChi" class="form-control" id="tennsx" name="mahd" aria-describedby="emailHelp" placeholder="Enter Tên NSX">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="staticEmail" class="col-sm-2 col-form-label" style="font-weight:bold">SĐT</label>
                                <div class="col-sm-10">
                                    <input type="text" readonly value="@hd.SDT" class="form-control" id="tennsx" name="mahd" aria-describedby="emailHelp" placeholder="Enter Tên NSX">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="staticEmail" style="font-weight:bold" class="col-sm-2 col-form-label">Tổng Tiền</label>
                                <div class="col-sm-10">
                                    <input type="text" readonly value="@hd.TongTien VNĐ" class="form-control" id="tennsx" name="mahd" aria-describedby="emailHelp" placeholder="Enter Tên NSX">
                                </div>
                            </div>


                            

                            
            

                           @if (hd.TinhTrangDonHang == "Chưa Xác Nhận")
                           {
                            <div class="form-group row">
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-3">
                                            @Html.ActionLink("Xác Nhận", "Check", "CTHD", new { confirm = true, idHD = hd.MaHD }, new { onclick = "return confirm('Do you want to check this shit?')", @class = "btn btn-primary", @style = "width:100px;" })
                                        </div>
                                        <div class="col-2">
                                            @Html.ActionLink("Hủy", "Delete", "CTHD", new { confirm = true, idHD = hd.MaHD }, new { onclick = "return confirm('Do you want to đelete this shit?')", @class = "btn btn-primary", @style = "width:100px;" })
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                           }
                           else if (hd.TinhTrangDonHang == "Chờ Giao Hàng")
                           {
                            <div class="form-group row">
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-3">
                                            @Html.ActionLink("Giao", "GiaoHang", "CTHD", new { confirm = true, idHD = hd.MaHD }, new { onclick = "return confirm('Do you want to check this shit?')", @class = "btn btn-primary", @style = "width:100px;" })
                                        </div>
                                        <div class="col-2">
                                            @Html.ActionLink("Hủy", "Delete", "CTHD", new { confirm = true, idHD = hd.MaHD }, new { onclick = "return confirm('Do you want to đelete this shit?')", @class = "btn btn-primary", @style = "width:100px;" })
                                        </div>
                                    </div>
                                </div>

                            </div>
                           }
                           else if (hd.TinhTrangDonHang == "Đang Giao Hàng")
                           {
                            <div class="form-group row">
                                <div class="col-6">
                                    <div class="row">
                                        <div class="col-3">
                                         @Html.ActionLink("Đã Giao", "DaGiao", "CTHD", new { confirm = true, idHD = hd.MaHD }, new { onclick = "return confirm('Do you want to check this shit?')", @class = "btn btn-primary", @style = "width:100px;" })
                                        </div>
                                           
                                        <div class="col-2">
                                            @Html.ActionLink("Hủy", "Delete", "CTHD", new { confirm = true, idHD = hd.MaHD }, new { onclick = "return confirm('Do you want to đelete this shit?')", @class = "btn btn-primary", @style = "width:100px;" })
                                        </div>
                                    </div>
                                </div>

                            </div>
                           }
                        </form>
                    }
                </div>
            </div>
        </div>
        <div class="container mt-5">
            @if (hd.TinhTrangDonHang=="Giao Thành Công" || hd.TinhTrangDonHang=="Đang Giao Hàng") {
            <table id="example1" class="table" style="width:100%;">
                <thead class="thead-dark">
                    <tr style="background-color:aliceblue">
                        <th scope="col" class="text-center">Tên Mô Hình</th>
                        <th scope="col" style="width:150px;" class="text-center">Hình Ảnh</th>
                        <th scope="col" class="text-center">Đơn Giá</th>
                        <th scope="col" class="text-center">Số Lượng</th>
                        <th scope="col" class="text-center">Thành Tiền</th>
                    </tr>
                </thead>

                @{
                    var list = Session["ListCTHDAdmin"] as List<WebApplication30.Models.ChiTietHoaDon>;
                }
                @if (list != null)
                {
                    <tbody>
                        @foreach (var item in list)
                        {
                            <tr>
                                <td class="text-center">@item.Kinh.TenKinh</td>
                                <td>
                                    <img style="width: 80px;height: 95px;display: block; margin-left: auto; margin-right: auto;"
                                         src="~/UploadedFiles/@item.Kinh.AnhBia" alt="image">
                                </td>
                                <td class="text-center">@item.DonGia</td>
                                <td class="text-center">@item.SoLuong</td>
                                <td class="text-center">@item.ThanhTien</td>
                            </tr>
                        }
                    </tbody>
                }

            </table>}
                    else
                    {
                        <table id="example1" class="table" style="width:100%;">
                            <thead class="thead-dark">
                                <tr style="background-color:aliceblue">
                                    <th scope="col" style="width:150px;" class="text-center">Hình Ảnh</th>
                                    <th scope="col" class="text-center">Tên Mô Hình</th>
                                    
                                    <th scope="col" class="text-center">Đơn Giá</th>
                                    <th scope="col" class="text-center">Số Lượng</th>
                                    <th scope="col" class="text-center">Thành Tiền</th>
                                    <th scope="col" class="text-center">Thao Tác</th>
                                </tr>
                            </thead>

                            @{
                                var list = Session["ListCTHDAdmin"] as List<WebApplication30.Models.ChiTietHoaDon>;
                            }
                            @if (list != null)
                {
                                <tbody>
                                    @foreach (var item in list)
                                    {
                                        <tr>
                                            <td><img style="width: 80px;height: 120px;display: block;margin-left: auto; margin-right: auto;" src="~/UploadedFiles/@item.Kinh.AnhBia"></td>
                                            <td><p>@item.Kinh.TenKinh</p></td>

                                            

                                            <td class="text-center">@item.DonGia VNĐ</td>
                                            @using (Html.BeginForm("UpdateSL", "CTHD"))
                                            {
                                                <td class="text-center">
                                                    <input type="number" hidden value="@item.SoLuong" name="slht"/>
                                                    <input type="text" hidden value="@item.MaCTHD" name="idCTHD" />
                                                    @*@Html.DropDownList("catID", (SelectList)ViewBag.Values, new { onchange = "this.form.submit();" })*@
                                                    <input type="number" required name="sl" value="@item.SoLuong" style="width:50px;" />


                                                </td>
                                                <td class="text-center">@item.ThanhTien VNĐ</td>

                                                <td class="text-center">
                                                    @Html.ActionLink("Xóa", "DeleteCTHD", "CTHD", new { confirm = true, idCTHD = item.MaCTHD }, new { onclick = "return confirm('Do you want to delete this shit?')", @class = "btn btn-primary" })
                                                <button type="submit" class="btn btn-primary">Sửa</button>
                                            </td>}
                                        </tr>
                                                }
                                </tbody>
                            }

                        </table>
                                }
        </div>
    </div>



</body>
</html>

